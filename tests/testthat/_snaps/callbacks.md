# early stopping

    Code
      expect_message({
        output <- mod %>% set_hparams(input_size = 10, output_size = 1) %>% fit(dl,
          verbose = TRUE, epochs = 25, callbacks = list(luz_callback_early_stopping(
            monitor = "train_loss", patience = 1)))
      })
    Message <message>
      Train metrics: Loss: 1.6053
      Early stopping at epoch 1 of 25

---

    Code
      expect_message({
        output <- mod %>% set_hparams(input_size = 10, output_size = 1) %>% fit(dl,
          verbose = TRUE, epochs = 25, callbacks = list(luz_callback_early_stopping(
            monitor = "train_loss", patience = 5, baseline = 0.001)))
      })
    Message <message>
      Train metrics: Loss: 1.279
      Epoch 2/25
      Train metrics: Loss: 1.2552
      Epoch 3/25
      Train metrics: Loss: 1.2335
      Epoch 4/25
      Train metrics: Loss: 1.2127
      Epoch 5/25
      Train metrics: Loss: 1.1927
      Early stopping at epoch 5 of 25

---

    Code
      expect_message({
        output <- mod %>% set_hparams(input_size = 10, output_size = 1) %>% fit(dl,
          verbose = TRUE, epochs = 25, callbacks = list(luz_callback_early_stopping(
            monitor = "train_mae", patience = 2, baseline = 0.91)))
      })
    Message <message>
      Train metrics: Loss: 1.2671 - MAE: 0.9163
      Epoch 2/25
      Train metrics: Loss: 1.2387 - MAE: 0.9058
      Epoch 3/25
      Train metrics: Loss: 1.212 - MAE: 0.8961
      Epoch 4/25
      Train metrics: Loss: 1.1866 - MAE: 0.8879
      Epoch 5/25
      Train metrics: Loss: 1.1625 - MAE: 0.8798
      Epoch 6/25
      Train metrics: Loss: 1.1396 - MAE: 0.8719
      Epoch 7/25
      Train metrics: Loss: 1.1179 - MAE: 0.8643
      Epoch 8/25
      Train metrics: Loss: 1.0973 - MAE: 0.8581
      Epoch 9/25
      Train metrics: Loss: 1.0778 - MAE: 0.8524
      Epoch 10/25
      Train metrics: Loss: 1.0593 - MAE: 0.847
      Epoch 11/25
      Train metrics: Loss: 1.0418 - MAE: 0.8417
      Epoch 12/25
      Train metrics: Loss: 1.0252 - MAE: 0.8365
      Epoch 13/25
      Train metrics: Loss: 1.0095 - MAE: 0.8314
      Epoch 14/25
      Train metrics: Loss: 0.9946 - MAE: 0.8265
      Epoch 15/25
      Train metrics: Loss: 0.9805 - MAE: 0.8216
      Epoch 16/25
      Train metrics: Loss: 0.9672 - MAE: 0.8168
      Epoch 17/25
      Train metrics: Loss: 0.9545 - MAE: 0.8122
      Epoch 18/25
      Train metrics: Loss: 0.9426 - MAE: 0.8077
      Epoch 19/25
      Train metrics: Loss: 0.9312 - MAE: 0.8035
      Epoch 20/25
      Train metrics: Loss: 0.9205 - MAE: 0.7994
      Epoch 21/25
      Train metrics: Loss: 0.9104 - MAE: 0.7953
      Epoch 22/25
      Train metrics: Loss: 0.9008 - MAE: 0.7914
      Epoch 23/25
      Train metrics: Loss: 0.8917 - MAE: 0.7875
      Epoch 24/25
      Train metrics: Loss: 0.8831 - MAE: 0.7838
      Epoch 25/25
      Train metrics: Loss: 0.8749 - MAE: 0.7801

# callback lr scheduler

    Code
      expect_message({
        output <- mod %>% set_hparams(input_size = 10, output_size = 1) %>% fit(dl,
          verbose = FALSE, epochs = 5, callbacks = list(luz_callback_lr_scheduler(
            torch::lr_multiplicative, verbose = TRUE, lr_lambda = function(epoch) 0.5)))
      })
    Message <message>
      Adjusting learning rate of group 1 to 0.0005
      Adjusting learning rate of group 1 to 0.0003
      Adjusting learning rate of group 1 to 0.0001
      Adjusting learning rate of group 1 to 0.0001
      Adjusting learning rate of group 1 to 0.0000

# progressbar appears with training and validation

    Code
      expect_message({
        output <- mod %>% set_hparams(input_size = 10, output_size = 1) %>% fit(dl,
          verbose = TRUE, epochs = 2, valid_data = dl)
      })
    Message <message>
      
      14/50 [===========>-------------------------------] - ETA:  1s - Loss: 1.3404 
      
      15/50 [============>------------------------------] - ETA:  1s - Loss: 1.3482 
      
      16/50 [=============>-----------------------------] - ETA:  1s - Loss: 1.3791 
      
      17/50 [==============>----------------------------] - ETA:  0s - Loss: 1.3673 
      
      18/50 [==============>----------------------------] - ETA:  0s - Loss: 1.3546 
      
      19/50 [===============>---------------------------] - ETA:  0s - Loss: 1.3151 
      
      20/50 [================>--------------------------] - ETA:  0s - Loss: 1.3574 
      
      21/50 [=================>-------------------------] - ETA:  0s - Loss: 1.3349 
      
      22/50 [==================>------------------------] - ETA:  0s - Loss: 1.3213 
      
      23/50 [===================>-----------------------] - ETA:  0s - Loss: 1.3358 
      
      24/50 [====================>----------------------] - ETA:  0s - Loss: 1.3515 
      
      25/50 [=====================>---------------------] - ETA:  0s - Loss: 1.3396 
      
      26/50 [=====================>---------------------] - ETA:  0s - Loss: 1.3406 
      
      27/50 [======================>--------------------] - ETA:  0s - Loss: 1.3277 
      
      28/50 [=======================>-------------------] - ETA:  0s - Loss: 1.3255 
      
      29/50 [=========================>------------------] - ETA:  0s - Loss: 1.318 
      
      30/50 [=========================>-----------------] - ETA:  0s - Loss: 1.3286 
      
      31/50 [==========================>----------------] - ETA:  0s - Loss: 1.3126 
      
      32/50 [===========================>---------------] - ETA:  0s - Loss: 1.2982 
      
      33/50 [===========================>---------------] - ETA:  0s - Loss: 1.2729 
      
      34/50 [============================>--------------] - ETA:  0s - Loss: 1.2532 
      
      35/50 [=============================>-------------] - ETA:  0s - Loss: 1.2309 
      
      36/50 [==============================>------------] - ETA:  0s - Loss: 1.2244 
      
      37/50 [===============================>-----------] - ETA:  0s - Loss: 1.2137 
      
      38/50 [================================>----------] - ETA:  0s - Loss: 1.2008 
      
      39/50 [=================================>---------] - ETA:  0s - Loss: 1.2288 
      
      40/50 [=================================>---------] - ETA:  0s - Loss: 1.2097 
      
      41/50 [==================================>--------] - ETA:  0s - Loss: 1.2079 
      
      42/50 [===================================>-------] - ETA:  0s - Loss: 1.2129 
      
      43/50 [====================================>------] - ETA:  0s - Loss: 1.2091 
      
      44/50 [=====================================>-----] - ETA:  0s - Loss: 1.2163 
      
      45/50 [======================================>----] - ETA:  0s - Loss: 1.2155 
      
      46/50 [=======================================>---] - ETA:  0s - Loss: 1.2157 
      
      47/50 [========================================>---] - ETA:  0s - Loss: 1.225 
      
      48/50 [========================================>--] - ETA:  0s - Loss: 1.2275 
      
      49/50 [=========================================>-] - ETA:  0s - Loss: 1.2284 
      
      50/50 [===========================================] - ETA:  0s - Loss: 1.2326 
                                                                                    
      
      
      16/50 [=============>-----------------------------] - ETA:  0s - Loss: 1.3155 
      
      17/50 [==============>----------------------------] - ETA:  0s - Loss: 1.3041 
      
      18/50 [==============>----------------------------] - ETA:  0s - Loss: 1.2937 
      
      19/50 [===============>---------------------------] - ETA:  0s - Loss: 1.2579 
      
      20/50 [=================>--------------------------] - ETA:  0s - Loss: 1.297 
      
      21/50 [=================>-------------------------] - ETA:  0s - Loss: 1.2771 
      
      22/50 [==================>------------------------] - ETA:  0s - Loss: 1.2645 
      
      23/50 [===================>-----------------------] - ETA:  0s - Loss: 1.2773 
      
      24/50 [====================>----------------------] - ETA:  0s - Loss: 1.2919 
      
      25/50 [=====================>---------------------] - ETA:  0s - Loss: 1.2804 
      
      26/50 [=====================>---------------------] - ETA:  0s - Loss: 1.2812 
      
      27/50 [======================>--------------------] - ETA:  0s - Loss: 1.2682 
      
      28/50 [=======================>-------------------] - ETA:  0s - Loss: 1.2667 
      
      29/50 [=========================>-------------------] - ETA:  0s - Loss: 1.26 
      
      30/50 [=========================>------------------] - ETA:  0s - Loss: 1.271 
      
      31/50 [==========================>----------------] - ETA:  0s - Loss: 1.2566 
      
      32/50 [===========================>---------------] - ETA:  0s - Loss: 1.2422 
      
      33/50 [===========================>---------------] - ETA:  0s - Loss: 1.2184 
      
      34/50 [============================>--------------] - ETA:  0s - Loss: 1.2003 
      
      35/50 [=============================>-------------] - ETA:  0s - Loss: 1.1792 
      
      36/50 [==============================>------------] - ETA:  0s - Loss: 1.1732 
      
      37/50 [===============================>-----------] - ETA:  0s - Loss: 1.1639 
      
      38/50 [================================>----------] - ETA:  0s - Loss: 1.1519 
      
      39/50 [==================================>----------] - ETA:  0s - Loss: 1.18 
      
      40/50 [=================================>---------] - ETA:  0s - Loss: 1.1619 
      
      41/50 [===================================>--------] - ETA:  0s - Loss: 1.161 
      
      42/50 [===================================>-------] - ETA:  0s - Loss: 1.1666 
      
      43/50 [====================================>------] - ETA:  0s - Loss: 1.1637 
      
      44/50 [=====================================>-----] - ETA:  0s - Loss: 1.1715 
      
      45/50 [======================================>----] - ETA:  0s - Loss: 1.1716 
      
      46/50 [=======================================>---] - ETA:  0s - Loss: 1.1726 
      
      47/50 [=======================================>---] - ETA:  0s - Loss: 1.1827 
      
      48/50 [========================================>--] - ETA:  0s - Loss: 1.1859 
      
      49/50 [=========================================>-] - ETA:  0s - Loss: 1.1876 
      
      50/50 [===========================================] - ETA:  0s - Loss: 1.1926 
                                                                                    
      
      Train metrics: Loss: 1.2326
      Valid metrics: Loss: 1.1926
      Epoch 2/2
      
      12/50 [=========>---------------------------------] - ETA:  1s - Loss: 1.3146 
      
      13/50 [==========>--------------------------------] - ETA:  1s - Loss: 1.3078 
      
      14/50 [===========>-------------------------------] - ETA:  1s - Loss: 1.2733 
      
      15/50 [============>------------------------------] - ETA:  1s - Loss: 1.2774 
      
      16/50 [=============>-----------------------------] - ETA:  1s - Loss: 1.3055 
      
      17/50 [==============>----------------------------] - ETA:  1s - Loss: 1.2932 
      
      18/50 [==============>----------------------------] - ETA:  1s - Loss: 1.2831 
      
      19/50 [===============>---------------------------] - ETA:  0s - Loss: 1.2478 
      
      20/50 [================>--------------------------] - ETA:  0s - Loss: 1.2837 
      
      21/50 [=================>-------------------------] - ETA:  0s - Loss: 1.2644 
      
      22/50 [==================>------------------------] - ETA:  0s - Loss: 1.2517 
      
      23/50 [===================>-----------------------] - ETA:  0s - Loss: 1.2628 
      
      24/50 [====================>-----------------------] - ETA:  0s - Loss: 1.276 
      
      25/50 [=====================>----------------------] - ETA:  0s - Loss: 1.264 
      
      26/50 [=====================>---------------------] - ETA:  0s - Loss: 1.2637 
      
      27/50 [=======================>---------------------] - ETA:  0s - Loss: 1.25 
      
      28/50 [=======================>-------------------] - ETA:  0s - Loss: 1.2487 
      
      29/50 [========================>------------------] - ETA:  0s - Loss: 1.2417 
      
      30/50 [=========================>------------------] - ETA:  0s - Loss: 1.252 
      
      31/50 [==========================>----------------] - ETA:  0s - Loss: 1.2382 
      
      32/50 [===========================>---------------] - ETA:  0s - Loss: 1.2224 
      
      33/50 [===========================>---------------] - ETA:  0s - Loss: 1.1986 
      
      34/50 [============================>--------------] - ETA:  0s - Loss: 1.1817 
      
      35/50 [=============================>-------------] - ETA:  0s - Loss: 1.1606 
      
      36/50 [==============================>------------] - ETA:  0s - Loss: 1.1536 
      
      37/50 [===============================>-----------] - ETA:  0s - Loss: 1.1445 
      
      38/50 [================================>----------] - ETA:  0s - Loss: 1.1325 
      
      39/50 [=================================>---------] - ETA:  0s - Loss: 1.1586 
      
      40/50 [===================================>---------] - ETA:  0s - Loss: 1.14 
      
      41/50 [==================================>--------] - ETA:  0s - Loss: 1.1389 
      
      42/50 [===================================>-------] - ETA:  0s - Loss: 1.1434 
      
      43/50 [====================================>------] - ETA:  0s - Loss: 1.1399 
      
      44/50 [=====================================>-----] - ETA:  0s - Loss: 1.1465 
      
      45/50 [======================================>----] - ETA:  0s - Loss: 1.1461 
      
      46/50 [=======================================>---] - ETA:  0s - Loss: 1.1472 
      
      47/50 [========================================>---] - ETA:  0s - Loss: 1.157 
      
      48/50 [========================================>--] - ETA:  0s - Loss: 1.1592 
      
      49/50 [=========================================>-] - ETA:  0s - Loss: 1.1604 
      
      50/50 [===========================================] - ETA:  0s - Loss: 1.1645 
                                                                                    
      
      
      15/50 [============>------------------------------] - ETA:  0s - Loss: 1.2303 
      
      16/50 [=============>-----------------------------] - ETA:  0s - Loss: 1.2567 
      
      17/50 [==============>----------------------------] - ETA:  0s - Loss: 1.2444 
      
      18/50 [==============>----------------------------] - ETA:  0s - Loss: 1.2359 
      
      19/50 [===============>---------------------------] - ETA:  0s - Loss: 1.2037 
      
      20/50 [================>--------------------------] - ETA:  0s - Loss: 1.2366 
      
      21/50 [=================>-------------------------] - ETA:  0s - Loss: 1.2194 
      
      22/50 [==================>------------------------] - ETA:  0s - Loss: 1.2074 
      
      23/50 [===================>-----------------------] - ETA:  0s - Loss: 1.2169 
      
      24/50 [====================>----------------------] - ETA:  0s - Loss: 1.2291 
      
      25/50 [=====================>---------------------] - ETA:  0s - Loss: 1.2174 
      
      26/50 [=====================>---------------------] - ETA:  0s - Loss: 1.2167 
      
      27/50 [======================>--------------------] - ETA:  0s - Loss: 1.2029 
      
      28/50 [========================>-------------------] - ETA:  0s - Loss: 1.202 
      
      29/50 [========================>------------------] - ETA:  0s - Loss: 1.1956 
      
      30/50 [=========================>-----------------] - ETA:  0s - Loss: 1.2061 
      
      31/50 [==========================>----------------] - ETA:  0s - Loss: 1.1937 
      
      32/50 [===========================>---------------] - ETA:  0s - Loss: 1.1779 
      
      33/50 [===========================>---------------] - ETA:  0s - Loss: 1.1552 
      
      34/50 [============================>--------------] - ETA:  0s - Loss: 1.1396 
      
      35/50 [=============================>-------------] - ETA:  0s - Loss: 1.1195 
      
      36/50 [==============================>------------] - ETA:  0s - Loss: 1.1129 
      
      37/50 [===============================>-----------] - ETA:  0s - Loss: 1.1049 
      
      38/50 [================================>----------] - ETA:  0s - Loss: 1.0936 
      
      39/50 [=================================>---------] - ETA:  0s - Loss: 1.1196 
      
      40/50 [=================================>---------] - ETA:  0s - Loss: 1.1019 
      
      41/50 [==================================>--------] - ETA:  0s - Loss: 1.1016 
      
      42/50 [===================================>-------] - ETA:  0s - Loss: 1.1066 
      
      43/50 [====================================>------] - ETA:  0s - Loss: 1.1037 
      
      44/50 [=====================================>-----] - ETA:  0s - Loss: 1.1107 
      
      45/50 [=======================================>----] - ETA:  0s - Loss: 1.111 
      
      46/50 [=======================================>---] - ETA:  0s - Loss: 1.1128 
      
      47/50 [=======================================>---] - ETA:  0s - Loss: 1.1232 
      
      48/50 [=========================================>--] - ETA:  0s - Loss: 1.126 
      
      49/50 [=========================================>-] - ETA:  0s - Loss: 1.1278 
      
      50/50 [===========================================] - ETA:  0s - Loss: 1.1325 
                                                                                    
      
      Train metrics: Loss: 1.1645
      Valid metrics: Loss: 1.1325

